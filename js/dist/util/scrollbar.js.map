{"version":3,"file":"scrollbar.js","sources":["../../src/util/scrollbar.js"],"sourcesContent":["/**\n * --------------------------------------------------------------------------\n * Bootstrap (v5.1.3): util/scrollBar.js\n * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)\n * --------------------------------------------------------------------------\n */\n\nimport SelectorEngine from '../dom/selector-engine'\nimport Manipulator from '../dom/manipulator'\nimport { isElement, getDocument, getWindow } from './index'\n\n/**\n * Constants\n */\n\nconst SELECTOR_FIXED_CONTENT = '.fixed-top, .fixed-bottom, .is-fixed, .sticky-top'\nconst SELECTOR_STICKY_CONTENT = '.sticky-top'\nconst PROPERTY_PADDING = 'padding-right'\nconst PROPERTY_MARGIN = 'margin-right'\n\n/**\n * Class definition\n */\n\nclass ScrollBarHelper {\n  constructor() {\n    this._element = getDocument().body\n    this._window = getWindow()\n  }\n\n  // Public\n  getWidth() {\n    // https://developer.mozilla.org/en-US/docs/Web/API/Window/innerWidth#usage_notes\n    const documentWidth = document.documentElement.clientWidth\n    return Math.abs(this._window.innerWidth - documentWidth)\n  }\n\n  hide() {\n    const width = this.getWidth()\n    this._disableOverFlow()\n    // give padding to element to balance the hidden scrollbar width\n    this._setElementAttributes(this._element, PROPERTY_PADDING, calculatedValue => calculatedValue + width)\n    // trick: We adjust positive paddingRight and negative marginRight to sticky-top elements to keep showing fullwidth\n    this._setElementAttributes(SELECTOR_FIXED_CONTENT, PROPERTY_PADDING, calculatedValue => calculatedValue + width)\n    this._setElementAttributes(SELECTOR_STICKY_CONTENT, PROPERTY_MARGIN, calculatedValue => calculatedValue - width)\n  }\n\n  reset() {\n    this._resetElementAttributes(this._element, 'overflow')\n    this._resetElementAttributes(this._element, PROPERTY_PADDING)\n    this._resetElementAttributes(SELECTOR_FIXED_CONTENT, PROPERTY_PADDING)\n    this._resetElementAttributes(SELECTOR_STICKY_CONTENT, PROPERTY_MARGIN)\n  }\n\n  isOverflowing() {\n    return this.getWidth() > 0\n  }\n\n  // Private\n  _disableOverFlow() {\n    this._saveInitialAttribute(this._element, 'overflow')\n    this._element.style.overflow = 'hidden'\n  }\n\n  _setElementAttributes(selector, styleProperty, callback) {\n    const scrollbarWidth = this.getWidth()\n    const manipulationCallBack = element => {\n      if (element !== this._element && this._window.innerWidth > element.clientWidth + scrollbarWidth) {\n        return\n      }\n\n      this._saveInitialAttribute(element, styleProperty)\n      const calculatedValue = this._window.getComputedStyle(element).getPropertyValue(styleProperty)\n      element.style.setProperty(styleProperty, `${callback(Number.parseFloat(calculatedValue))}px`)\n    }\n\n    this._applyManipulationCallback(selector, manipulationCallBack)\n  }\n\n  _saveInitialAttribute(element, styleProperty) {\n    const actualValue = element.style.getPropertyValue(styleProperty)\n    if (actualValue) {\n      Manipulator.setDataAttribute(element, styleProperty, actualValue)\n    }\n  }\n\n  _resetElementAttributes(selector, styleProperty) {\n    const manipulationCallBack = element => {\n      const value = Manipulator.getDataAttribute(element, styleProperty)\n      // We only want to remove the property if the value is `null`; the value can also be zero\n      if (value === null) {\n        element.style.removeProperty(styleProperty)\n        return\n      }\n\n      Manipulator.removeDataAttribute(element, styleProperty)\n      element.style.setProperty(styleProperty, value)\n    }\n\n    this._applyManipulationCallback(selector, manipulationCallBack)\n  }\n\n  _applyManipulationCallback(selector, callBack) {\n    if (isElement(selector)) {\n      callBack(selector)\n      return\n    }\n\n    for (const sel of SelectorEngine.find(selector, this._element)) {\n      callBack(sel)\n    }\n  }\n}\n\nexport default ScrollBarHelper\n"],"names":["SELECTOR_FIXED_CONTENT","SELECTOR_STICKY_CONTENT","PROPERTY_PADDING","PROPERTY_MARGIN","ScrollBarHelper","constructor","_element","getDocument","body","_window","getWindow","getWidth","documentWidth","document","documentElement","clientWidth","Math","abs","innerWidth","hide","width","_disableOverFlow","_setElementAttributes","calculatedValue","reset","_resetElementAttributes","isOverflowing","_saveInitialAttribute","style","overflow","selector","styleProperty","callback","scrollbarWidth","manipulationCallBack","element","getComputedStyle","getPropertyValue","setProperty","Number","parseFloat","_applyManipulationCallback","actualValue","Manipulator","setDataAttribute","value","getDataAttribute","removeProperty","removeDataAttribute","callBack","isElement","sel","SelectorEngine","find"],"mappings":"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"}
'use strict';

var path = require('path');

var COMMONJS_BANNER = '// This file is autogenerated via the `commonjs` Grunt task. You can require() this file in a CommonJS environment.\n';
var COMMONJS_HEAD = '\nmodule.exports = function(jQuery) {\n';
var COMMONJS_FOOT = '\n};\n';

module.exports = function generateCommonJSModule(grunt) {
  var srcPath = 'js/';
  var npmPath = 'dist/js/npm/';
  var files = ['affix', 'alert', 'button', 'carousel', 'collapse', 'dropdown', 'modal', 'popover', 'scrollspy', 'tab', 'tooltip', 'transition'];
  function commonizeFile (srcPath, destPath) {
    var finalCode = COMMONJS_BANNER;
    finalCode += COMMONJS_HEAD;
    finalCode += grunt.file.read(srcPath);
    finalCode += COMMONJS_FOOT;
    grunt.file.write(destPath, finalCode);
    grunt.log.writeln('File ' + destPath.cyan + ' created.');
  }
  files.forEach(function (file) {
    commonizeFile(path.resolve(srcPath + file + '.js'), path.resolve(npmPath + 'bootstrap-' + file + '/' + 'index.js'));
  });
};
